<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventory - Laptop Tracking System</title>
    <link rel="stylesheet" href="/static/css/output.css" />
</head>
<body class="bg-gray-50 min-h-screen">
    {{template "navbar.html" .}}

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
        <!-- Header -->
        <div class="mb-8">
            <div class="flex items-center justify-between">
                <div>
                    <h2 class="text-3xl font-bold text-gray-900">Laptop Inventory</h2>
                    <p class="mt-2 text-gray-600">Manage and track all laptop devices</p>
                </div>
                {{if or (eq .User.Role "logistics") (eq .User.Role "warehouse")}}
                <a href="/inventory/add" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium">
                    + Add Laptop
                </a>
                {{end}}
            </div>
        </div>

        <!-- Search and Filter Bar -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <form method="GET" action="/inventory" class="flex flex-col md:flex-row gap-4">
                <!-- Search Input -->
                <div class="flex-1">
                    <label for="search" class="block text-sm font-medium text-gray-700 mb-1">Search</label>
                    <input 
                        type="text" 
                        id="search" 
                        name="search" 
                        value="{{.SearchQuery}}"
                        placeholder="Search by serial number, brand, or model..."
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    />
                </div>

                <!-- Status Filter -->
                <div class="w-full md:w-48">
                    <label for="status" class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                    <select 
                        id="status" 
                        name="status"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    >
                        <option value="">All Statuses</option>
                        {{range .Statuses}}
                        <option value="{{.}}" {{if eq . $.StatusFilter}}selected{{end}}>
                            {{laptopStatusDisplayName .}}
                        </option>
                        {{end}}
                    </select>
                </div>

                <!-- Search Button -->
                <div class="flex items-end">
                    <button 
                        type="submit"
                        class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium"
                    >
                        Search
                    </button>
                </div>
            </form>
        </div>

        <!-- Inventory Table -->
        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            {{if .Laptops}}
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <!-- Serial Number (Sortable) -->
                            <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                <a href="/inventory?search={{.SearchQuery}}&status={{.StatusFilter}}&sort=serial_number&order={{if and (eq .SortBy "serial_number") (eq .SortOrder "asc")}}desc{{else}}asc{{end}}" class="flex items-center space-x-1 hover:text-gray-700">
                                    <span>Serial Number</span>
                                    {{if eq .SortBy "serial_number"}}
                                        {{if eq .SortOrder "asc"}}
                                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M5 10l5-5 5 5H5z"/></svg>
                                        {{else}}
                                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M15 10l-5 5-5-5h10z"/></svg>
                                        {{end}}
                                    {{end}}
                                </a>
                            </th>
                            <!-- Brand/Model (Sortable) -->
                            <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                <a href="/inventory?search={{.SearchQuery}}&status={{.StatusFilter}}&sort=brand&order={{if and (eq .SortBy "brand") (eq .SortOrder "asc")}}desc{{else}}asc{{end}}" class="flex items-center space-x-1 hover:text-gray-700">
                                    <span>Brand/Model</span>
                                    {{if eq .SortBy "brand"}}
                                        {{if eq .SortOrder "asc"}}
                                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M5 10l5-5 5 5H5z"/></svg>
                                        {{else}}
                                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M15 10l-5 5-5-5h10z"/></svg>
                                        {{end}}
                                    {{end}}
                                </a>
                            </th>
                            <!-- Status (Sortable) -->
                            <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                <a href="/inventory?search={{.SearchQuery}}&status={{.StatusFilter}}&sort=status&order={{if and (eq .SortBy "status") (eq .SortOrder "asc")}}desc{{else}}asc{{end}}" class="flex items-center space-x-1 hover:text-gray-700">
                                    <span>Status</span>
                                    {{if eq .SortBy "status"}}
                                        {{if eq .SortOrder "asc"}}
                                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M5 10l5-5 5 5H5z"/></svg>
                                        {{else}}
                                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M15 10l-5 5-5-5h10z"/></svg>
                                        {{end}}
                                    {{end}}
                                </a>
                            </th>
                            {{if eq .User.Role "warehouse"}}
                            <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Reception Report
                            </th>
                            {{else if eq .User.Role "logistics"}}
                            <!-- Client (Sortable) -->
                            <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                <a href="/inventory?search={{.SearchQuery}}&status={{.StatusFilter}}&sort=client_company&order={{if and (eq .SortBy "client_company") (eq .SortOrder "asc")}}desc{{else}}asc{{end}}" class="flex items-center space-x-1 hover:text-gray-700">
                                    <span>Client</span>
                                    {{if eq .SortBy "client_company"}}
                                        {{if eq .SortOrder "asc"}}
                                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M5 10l5-5 5 5H5z"/></svg>
                                        {{else}}
                                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M15 10l-5 5-5-5h10z"/></svg>
                                        {{end}}
                                    {{end}}
                                </a>
                            </th>
                            <!-- Assigned to SE (Sortable) -->
                            <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                <a href="/inventory?search={{.SearchQuery}}&status={{.StatusFilter}}&sort=assigned_se&order={{if and (eq .SortBy "assigned_se") (eq .SortOrder "asc")}}desc{{else}}asc{{end}}" class="flex items-center space-x-1 hover:text-gray-700">
                                    <span>Assigned to SE</span>
                                    {{if eq .SortBy "assigned_se"}}
                                        {{if eq .SortOrder "asc"}}
                                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M5 10l5-5 5 5H5z"/></svg>
                                        {{else}}
                                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M15 10l-5 5-5-5h10z"/></svg>
                                        {{end}}
                                    {{end}}
                                </a>
                            </th>
                            <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Reception Report
                            </th>
                            {{else}}
                            <!-- Client (Sortable) -->
                            <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                <a href="/inventory?search={{.SearchQuery}}&status={{.StatusFilter}}&sort=client_company&order={{if and (eq .SortBy "client_company") (eq .SortOrder "asc")}}desc{{else}}asc{{end}}" class="flex items-center space-x-1 hover:text-gray-700">
                                    <span>Client</span>
                                    {{if eq .SortBy "client_company"}}
                                        {{if eq .SortOrder "asc"}}
                                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M5 10l5-5 5 5H5z"/></svg>
                                        {{else}}
                                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M15 10l-5 5-5-5h10z"/></svg>
                                        {{end}}
                                    {{end}}
                                </a>
                            </th>
                            <!-- Assigned to SE (Sortable) -->
                            <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                <a href="/inventory?search={{.SearchQuery}}&status={{.StatusFilter}}&sort=assigned_se&order={{if and (eq .SortBy "assigned_se") (eq .SortOrder "asc")}}desc{{else}}asc{{end}}" class="flex items-center space-x-1 hover:text-gray-700">
                                    <span>Assigned to SE</span>
                                    {{if eq .SortBy "assigned_se"}}
                                        {{if eq .SortOrder "asc"}}
                                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M5 10l5-5 5 5H5z"/></svg>
                                        {{else}}
                                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M15 10l-5 5-5-5h10z"/></svg>
                                        {{end}}
                                    {{end}}
                                </a>
                            </th>
                            {{end}}
                            <!-- Actions (Not Sortable) -->
                            <th scope="col" class="px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Actions
                            </th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        {{range .Laptops}}
                        <tr class="hover:bg-gray-50 transition-colors">
                            <td class="px-4 py-4 whitespace-nowrap">
                                <div class="text-sm font-medium text-gray-900">{{.SerialNumber}}</div>
                                {{if .SKU}}<div class="text-xs text-gray-500">{{.SKU}}</div>{{end}}
                            </td>
                            <td class="px-3 py-4">
                                <div class="text-sm text-gray-900">
                                    {{if .Brand}}{{.Brand}}{{else}}-{{end}}
                                    {{if .Model}}{{if .Brand}} {{end}}{{.Model}}{{end}}
                                </div>
                                {{if or .CPU .RAMGB .SSDGB}}
                                <div class="text-xs text-gray-500">
                                    {{if .CPU}}{{.CPU}}{{end}}
                                    {{if and .CPU .RAMGB}}, {{end}}
                                    {{if .RAMGB}}{{.RAMGB}} RAM{{end}}
                                    {{if and .RAMGB .SSDGB}}, {{end}}
                                    {{if and .CPU (not .RAMGB) .SSDGB}}, {{end}}
                                    {{if .SSDGB}}{{.SSDGB}} SSD{{end}}
                                </div>
                                {{end}}
                            </td>
                            <td class="px-3 py-4 whitespace-nowrap">
                                <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full {{inventoryStatusColor .Status}}">
                                    {{laptopStatusDisplayName .Status}}
                                </span>
                            </td>
                            {{if eq $.User.Role "warehouse"}}
                            <td class="px-3 py-4">
                                {{if .HasReceptionReport}}
                                    <div class="flex flex-col space-y-2">
                                        <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full {{receptionReportStatusColor .ReceptionReportStatus}}">
                                            {{receptionReportStatusDisplayName .ReceptionReportStatus}}
                                        </span>
                                        {{if .ReceptionReportID}}
                                        <a href="/reception-reports/{{.ReceptionReportID}}" class="inline-flex items-center justify-center px-3 py-1 text-xs font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-md transition-colors">
                                            <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                            </svg>
                                            View Report
                                        </a>
                                        {{end}}
                                    </div>
                                {{else}}
                                    {{if eq .Status "at_warehouse"}}
                                    <a href="/laptops/{{.ID}}/reception-report" class="inline-flex items-center justify-center px-3 py-1 text-xs font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md transition-colors shadow-sm">
                                        <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                                        </svg>
                                        Create Report
                                    </a>
                                    {{else}}
                                    <span class="text-xs text-gray-500">-</span>
                                    {{end}}
                                {{end}}
                            </td>
                            {{else if eq $.User.Role "logistics"}}
                            <td class="px-3 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900">{{if .ClientCompanyName}}{{.ClientCompanyName}}{{else}}-{{end}}</div>
                            </td>
                            <td class="px-3 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900">
                                    {{if .SoftwareEngineerName}}
                                        <div>{{.SoftwareEngineerName}}</div>
                                    {{else}}-{{end}}
                                </div>
                            </td>
                            <td class="px-3 py-4">
                                {{if .HasReceptionReport}}
                                    <div class="flex flex-col space-y-2">
                                        <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full {{receptionReportStatusColor .ReceptionReportStatus}}">
                                            {{receptionReportStatusDisplayName .ReceptionReportStatus}}
                                        </span>
                                        {{if .ReceptionReportID}}
                                        <a href="/reception-reports/{{.ReceptionReportID}}" class="inline-flex items-center justify-center px-3 py-1 text-xs font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-md transition-colors">
                                            <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                            </svg>
                                            View Report
                                        </a>
                                        {{end}}
                                    </div>
                                {{else}}
                                    <span class="text-xs text-gray-500">No Report</span>
                                {{end}}
                            </td>
                            {{else}}
                            <td class="px-3 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900">{{if .ClientCompanyName}}{{.ClientCompanyName}}{{else}}-{{end}}</div>
                            </td>
                            <td class="px-3 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900">
                                    {{if .SoftwareEngineerName}}
                                        <div>{{.SoftwareEngineerName}}</div>
                                    {{else}}-{{end}}
                                </div>
                            </td>
                            {{end}}
                            <td class="px-3 py-4 whitespace-nowrap text-right text-sm font-medium">
                                <div class="flex items-center justify-end space-x-2">
                                    <a href="/inventory/{{.ID}}" class="text-blue-600 hover:text-blue-900">View</a>
                                    {{if or (eq $.User.Role "logistics") (eq $.User.Role "warehouse")}}
                                    <a href="/inventory/{{.ID}}/edit" class="text-green-600 hover:text-green-900">Edit</a>
                                    {{end}}
                                </div>
                            </td>
                        </tr>
                        {{end}}
                    </tbody>
                </table>
            </div>
            {{else}}
            <div class="text-center py-12">
                <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                <h3 class="mt-4 text-lg font-medium text-gray-900">No laptops found</h3>
                <p class="mt-2 text-gray-600">{{if or .SearchQuery .StatusFilter}}Try adjusting your search criteria{{else}}Add a laptop to get started{{end}}</p>
            </div>
            {{end}}
        </div>
    </div>
</body>
</html>

